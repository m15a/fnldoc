# Markdown.fnl (1.1.0-dev)

Functions for generating Markdown.

## Overview

Full module documentation structure looks like this:

````````markdown
# Module name (module version)

Module top-level description.
...

**Table of contents**

- Function: [`some-function`](#function-some-function)
- Macro: [`some-macro`](#macro-some-macro)
- ...

## Function: `some-function`

```
(some-function signature)
```
Some function description.
...

## Macro: `some-macro`

```
(some-macro signature)
```

Some macro description.
...


---

Copyright (C) ...

License: ...

<!-- Generated with Fnldoc 1.x.x
     ... -->
````````

Level-1 heading is generated by [`title-heading`](#function-title-heading).

Module top-level description is extracted from the top comments
beginning with `;;;; ` or specified in `.fenneldoc`. It will be
filtered by [`remove-test-skip`](#function-remove-test-skip) and [`replace-inline-references`](#function-replace-inline-references)
(explained later).

Table of contents lists module items, which is sorted by
[`sorted-item-index`](#function-sorted-item-index), and generated by [`table-of-contents`](#function-table-of-contents). It also
generates a table called *anchor map* that maps each module item to
each *anchor* identifier, which will be used here and there for
internal linking (a.k.a. inline references).

Each module item has documentation generated by [`item-documentation`](#function-item-documentation),
which consists of subheading, [`function-signature`](#function-function-signature), and description.
Subheading shows its type (i.e., `Function:` or `Macro:`) and name.
Description is its metadata field `:fnl/docstring`.

After `---`, it may contain [`copyright-and-license`](#function-copyright-and-license) information,
and the [`final-comment`](#function-final-comment), which is just a HTML comment containing
`Generated by Fnldoc ...` stuff.

All in all, [`module-info->markdown`](#function-module-info-markdown) does one-stop conversion from module
information to Markdown documentation. Each component of the
documentation structure can be customized (e.g., whether to show module
version) by configuration.

**Table of contents**

- Function: [`copyright-and-license`](#function-copyright-and-license)
- Function: [`final-comment`](#function-final-comment)
- Function: [`function-signature`](#function-function-signature)
- Function: [`inline-references`](#function-inline-references)
- Function: [`item-documentation`](#function-item-documentation)
- Function: [`item-index->anchor-map`](#function-item-index-anchor-map)
- Function: [`module-info->markdown`](#function-module-info-markdown)
- Function: [`remove-test-skip`](#function-remove-test-skip)
- Function: [`replace-inline-references`](#function-replace-inline-references)
- Function: [`sorted-item-index`](#function-sorted-item-index)
- Function: [`table-of-contents`](#function-table-of-contents)
- Function: [`title-heading`](#function-title-heading)

## Function: `copyright-and-license`

```
(copyright-and-license ?copyright ?license)
```

Generate `?copyright` and/or `?license` text if any.

## Function: `final-comment`

```
(final-comment fnldoc-version)
```

Generate the final comment with `fnldoc-version`.

## Function: `function-signature`

```
(function-signature function arglist)
```

Make a signature code fence of `function` with the `arglist`.

## Function: `inline-references`

```
(inline-references text)
```

Collect all inline references (e.g., ```ref```) in the `text`.

## Function: `item-documentation`

```
(item-documentation item metadata anchor-map config)
```

Generate `item`'s documentation with `metadata` accordingly to `config`.

`anchor-map` is used to translate ```item``` to internal link.

## Function: `item-index->anchor-map`

```
(item-index->anchor-map item-index metadata)
```

Get mapping from item to its internal link anchor for the `item-index`.

`metadata` is used to make anchor depending on function's type: function
or macro.

## Function: `module-info->markdown`

```
(module-info->markdown module-info config)
```

Generate markdown from `module-info` accordingly to the `config`.

## Function: `remove-test-skip`

```
(remove-test-skip text)
```

Remove all `:skip-test` annotations from markdown fences in the `text`.

## Function: `replace-inline-references`

```
(replace-inline-references text anchor-map mode)
```

Replace inline references in the `text` using `anchor-map`.

`mode` should be either `:link` or `:code`.

## Function: `sorted-item-index`

```
(sorted-item-index module-info config)
```

Sort the item index of `module-info` and return it as a sequential table.

The sort will be done according to the `order` specified in `module-info`
or the `config`.

## Function: `table-of-contents`

```
(table-of-contents item-index metadata)
```

Generate Table of contents for the `item-index`.

It returns multiple values in which firstly the ToC itself, and secondary
corresponding anchor mapping.

`metadata` is used to show each function's type: function or macro.

## Function: `title-heading`

```
(title-heading title ?version)
```

Generate module `title` as Markdown level 1 heading.

`?version` string may be specified if any. The `title` may be specified in
`.fenneldoc` or fall back to the file name.

---

Copyright (C) 2020-2022 Andrey Listopadov, 2024 NACAMURA Mitsuhiro

License: [MIT](https://git.sr.ht/~m15a/fnldoc/tree/main/item/LICENSE)

<!-- Generated with Fnldoc 1.1.0-dev
     https://sr.ht/~m15a/fnldoc/ -->
